<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-cn" lang="zh-cn" data-whc_version="26.0">
    <head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="内核配置 进入 kernel 的功能配置界面 在 SDK 根目录下，执行下列命令，进入 kernel 的功能配置界面： make kernel-menuconfig 或使用简写命令 make km 配置网络功能 如需在内核中使用以太网功能，则在内核配置界面打开和配置网络相关功能，如下所示： [*] Networking support Networking options &lt;*&gt; Packet ..."/><meta name="DC.rights.owner" content="(C) 版权 2025"/><meta name="copyright" content="(C) 版权 2025"/><meta name="generator" content="DITA-OT"/><meta name="DC.type" content="concept"/><meta name="DC.contributor" content="yan.wang"/><meta name="DC.date.modified" content="2024-12-17"/><meta name="DC.format" content="HTML5"/><meta name="DC.identifier" content="mac_configuration"/><meta name="DC.language" content="zh-CN"/><title>参数配置</title><!--  Build number 2023110923.  --><meta name="wh-path2root" content="../../../"/><meta name="wh-toc-id" content=""/><meta name="wh-source-relpath" content="topics/sdk/mac/mac_config.dita"/><meta name="wh-out-relpath" content="topics/sdk/mac/mac_config.html"/>

    <link rel="stylesheet" type="text/css" href="../../../webhelp/app/commons.css?buildId=2023110923"/>
    <link rel="stylesheet" type="text/css" href="../../../webhelp/app/topic.css?buildId=2023110923"/>

    <script src="../../../webhelp/app/options/properties.js?buildId=20250121171154"></script>
    <script src="../../../webhelp/app/localization/strings.js?buildId=2023110923"></script>
    <script src="../../../webhelp/app/search/index/keywords.js?buildId=20250121171154"></script>
    <script defer="defer" src="../../../webhelp/app/commons.js?buildId=2023110923"></script>
    <script defer="defer" src="../../../webhelp/app/topic.js?buildId=2023110923"></script>
<link rel="stylesheet" type="text/css" href="../../../webhelp/template/aic-styles-web.css?buildId=2023110923"/><link rel="stylesheet" type="text/css" href="../../../webhelp/template/notes.css?buildId=2023110923"/><link rel="stylesheet" type="text/css" href="../../../webhelp/template/aic-common.css?buildId=2023110923"/><link rel="stylesheet" type="text/css" href="../../../webhelp/template/aic-images.css?buildId=2023110923"/><link rel="stylesheet" type="text/css" href="../../../webhelp/template/footnote.css?buildId=2023110923"/><link rel="stylesheet" type="text/css" href="../../../webhelp/template/aic-web-watermark.css?buildId=2023110923"/><link rel="stylesheet" type="text/css" href="../../../webhelp/template/topic-body-list.css?buildId=2023110923"/></head>

    <body id="mac_configuration" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            跳转到主要内容
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="http://www.artinchip.com" class=" wh_logo d-none d-sm-block "><img src="../../../company-logo-white.png" alt="RTOS SDK 使用指南SDK 指南文件"/></a>
                    <div class=" wh_publication_title "><a href="../../../index.html"><span class="booktitle"><span class="ph mainbooktitle">RTOS SDK 使用指南</span><span class="ph booktitlealt">SDK 指南文件</span></span></a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        </div>
    </div>
</header>
        
        
         
        
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="../../../search.html"><div><input type="search" placeholder="搜索 " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="搜索查询" required="required"/><button type="submit" class="wh_search_button" aria-label="搜索"><span class="search_input_text">搜索</span></button></div></form>
            
            
            
        </div>
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="切换搜索突出显示" title="切换搜索突出显示"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="折叠截面" title="折叠截面"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="打印此页" aria-label="打印此页"></button></div>
                        
                        
                    </div>
                    
                </nav>
            </div>
            
            
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                    
                    <div class="col-lg-10 col-md-10 col-sm-10 col-xs-12" id="wh_topic_body">
                        
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article class="- topic/topic concept/concept topic concept" role="article" aria-labelledby="ariaid-title1"><span class="edit-link" style="font-size:12px; opacity:0.6; text-align:right; vertical-align:middle"><a target="_blank" href="http://172.16.35.88/tasks/jdssno1uvvbf2mltu9kb9v3if05d5gopuakboe8hlud18rma/edit/F:/aicdita/aicdita-cn/topics/sdk/mac/mac_config.dita">Edit online</a></span><h1 class="- topic/title title topictitle1" id="ariaid-title1">参数配置</h1><div class="date inPage">17 Dec 2024</div><div style="color: gray;">
                    Read time: 5 minute(s)
                </div><div class="- topic/body concept/conbody body conbody"><section class="- topic/section section" id="mac_configuration__section_j4p_jts_4dc" data-ofbid="mac_configuration__section_j4p_jts_4dc"><h2 class="- topic/title title sectiontitle">内核配置</h2>
            
            <ol class="- topic/ol ol" id="mac_configuration__ol_ptj_nts_4dc" data-ofbid="mac_configuration__ol_ptj_nts_4dc"><li class="- topic/li li" data-ofbid="d46685e28__20250121171517">
                    <div class="- topic/p p" data-ofbid="d46685e30__20250121171517"><strong class="+ topic/ph hi-d/b ph b">进入 kernel 的功能配置界面</strong><div class="- topic/div div">
                <div class="- topic/p p" data-ofbid="d46685e35__20250121171517">在 SDK 根目录下，执行下列命令，进入 kernel
                    的功能配置界面：<pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="mac_configuration__codeblock_wg1_3ml_sdc" data-ofbid="mac_configuration__codeblock_wg1_3ml_sdc">make kernel-menuconfig</pre></div>
                <p class="- topic/p p" data-ofbid="d46685e40__20250121171517">或使用简写命令</p>
                <div class="- topic/p p" data-ofbid="d46685e43__20250121171517">
                    <pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="mac_configuration__codeblock_uss_hml_sdc" data-ofbid="mac_configuration__codeblock_uss_hml_sdc">make km</pre>
                </div>
            </div></div>
                </li><li class="- topic/li li" data-ofbid="d46685e50__20250121171517">
                    <div class="- topic/div div" id="mac_configuration__section_dr2_xxr_21c"><strong class="+ topic/ph hi-d/b ph b">配置网络功能</strong>
                        <div class="- topic/p p" data-ofbid="d46685e56__20250121171517">如需在内核中使用以太网功能，则在内核配置界面打开和配置网络相关功能，如下所示：<pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="mac_configuration__codeblock_lqx_yxr_21c" data-ofbid="mac_configuration__codeblock_lqx_yxr_21c">[*] Networking support
                    Networking options
                    &lt;*&gt; Packet socket
                    &lt;*&gt; Unix domain sockets
                    [*] TCP/IP networking
                    &lt;*&gt;   INET: socket monitoring interface
                    &lt;*&gt; DNS Resolver support
                    &lt;*&gt; NETLINK: socket monitoring interface</pre></div></div>
                </li><li class="- topic/li li" data-ofbid="d46685e61__20250121171517">
                    <div class="- topic/div div" id="mac_configuration__section_kz2_yxr_21c"><strong class="+ topic/ph hi-d/b ph b">模块驱动配置</strong>
                        <pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="mac_configuration__codeblock_hcb_zxr_21c" data-ofbid="mac_configuration__codeblock_hcb_zxr_21c">Device Drivers
                        [*] Network device support
                        [*] Ethernet driver support
                        [*] ArtInChip Gigabit Ethernet driver</pre>
                    </div>
                </li></ol>
        </section><section class="- topic/section section" id="mac_configuration__section_nz5_nts_4dc" data-ofbid="mac_configuration__section_nz5_nts_4dc"><h2 class="- topic/title title sectiontitle">系统参数配置</h2>
            
            <div class="- topic/p p" data-ofbid="d46685e77__20250121171517">系统参数主要存放于 <span class="+ topic/ph sw-d/filepath ph filepath">target/d211/common/d211.dtsi</span> 文件中，模块系统参数随 SoC
                设置而定，一般不得进行更改。如因更换了新的 SoC
                需要修改系统参数，必须在专业人士的指导下更改。<pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="mac_configuration__codeblock_lyn_1yr_21c" data-ofbid="mac_configuration__codeblock_lyn_1yr_21c">gmac0: ethernet@<span class="hl-number">10280000</span> {
    compatible = <span class="hl-string">"artinchip,aic-mac-v1.0"</span>;
    reg = &lt;<span class="hl-number">0x10280000</span> <span class="hl-number">0x10000</span>&gt;;
    interrupts = &lt;GIC_SPI <span class="hl-number">7</span> IRQ_TYPE_LEVEL_HIGH&gt;;
    interrupt-names = <span class="hl-string">"macirq"</span>;
    clocks = &lt;&amp;ccu CLK_GMAC0&gt;;
    clock-names = <span class="hl-string">"gmac"</span>;
    resets = &lt;&amp;rst RESET_GMAC0&gt;;
    reset-names = <span class="hl-string">"gmac"</span>;
};</pre></div>
        </section><section class="- topic/section section" id="mac_configuration__section_yz1_sts_4dc" data-ofbid="mac_configuration__section_yz1_sts_4dc"><h2 class="- topic/title title sectiontitle">功能参数配置</h2>
            
            <div class="- topic/p p" data-ofbid="d46685e90__20250121171517">功能参数主要针对某一个使用方案而定，不同的方案使用的参数可能不同。功能参数参数主要存放于 <span class="+ topic/ph sw-d/filepath ph filepath">
                    target/d211/xxx/board.dts</span> 文件中，功能参数的设置必须和硬件原理图相匹配。<div class="- topic/note note note note_note" id="mac_configuration__note_t5x_xws_4dc" data-ofbid="mac_configuration__note_t5x_xws_4dc"><span class="note__title">注：</span> 关于详细的参数描述，可查看<a xml:lang="zh-CN" lang="zh-CN" class="- topic/xref xref" href="mac_func_param.html">功能参数描述</a></div><ul class="- topic/ul ul" id="mac_configuration__ul_xq1_2yr_21c" data-ofbid="mac_configuration__ul_xq1_2yr_21c"><li class="- topic/li li" data-ofbid="d46685e101__20250121171517"><strong class="+ topic/ph hi-d/b ph b">GMAC
                        参数</strong><pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="mac_configuration__codeblock_sjd_5ws_4dc" data-ofbid="mac_configuration__codeblock_sjd_5ws_4dc">&amp;gmac0 {
     pinctrl-names = <span class="hl-string">"default"</span>;
     pinctrl-<span class="hl-number">0</span> = &lt;&amp;gmac0_<span class="hl-number">1000</span>m_pins&gt;;
     phy-handle = &lt;&amp;gmac0_phy&gt;;
     phy-reset-gpios = &lt;&amp;gpio_d <span class="hl-number">3</span> GPIO_ACTIVE_HIGH&gt;;
     phy-addr = &lt;<span class="hl-number">1</span>&gt;;
     phy-mode = <span class="hl-string">"rgmii"</span>;
     max-speed = &lt;<span class="hl-number">1000</span>&gt;;
     aic,tx-delay = &lt;<span class="hl-number">0xc</span>&gt;;
     aic,rx-delay = &lt;<span class="hl-number">0xc</span>&gt;;

     status = <span class="hl-string">"okay"</span>;

 gmac0_<span class="hl-number">1000</span>m_pins: gmac0-<span class="hl-number">0</span> {
     pins {
         pinmux = &lt;AIC_PINMUX(<span class="hl-string">'E'</span>, <span class="hl-number">0</span>, <span class="hl-number">6</span>)&gt;,
         &lt;AIC_PINMUX(<span class="hl-string">'E'</span>, <span class="hl-number">1</span>, <span class="hl-number">6</span>)&gt;,
         &lt;AIC_PINMUX(<span class="hl-string">'E'</span>, <span class="hl-number">2</span>, <span class="hl-number">6</span>)&gt;,
         &lt;AIC_PINMUX(<span class="hl-string">'E'</span>, <span class="hl-number">3</span>, <span class="hl-number">6</span>)&gt;,
         &lt;AIC_PINMUX(<span class="hl-string">'E'</span>, <span class="hl-number">4</span>, <span class="hl-number">6</span>)&gt;,
         &lt;AIC_PINMUX(<span class="hl-string">'E'</span>, <span class="hl-number">5</span>, <span class="hl-number">6</span>)&gt;,
         &lt;AIC_PINMUX(<span class="hl-string">'E'</span>, <span class="hl-number">6</span>, <span class="hl-number">6</span>)&gt;,
         &lt;AIC_PINMUX(<span class="hl-string">'E'</span>, <span class="hl-number">7</span>, <span class="hl-number">6</span>)&gt;,
         &lt;AIC_PINMUX(<span class="hl-string">'E'</span>, <span class="hl-number">8</span>, <span class="hl-number">6</span>)&gt;,
         &lt;AIC_PINMUX(<span class="hl-string">'E'</span>, <span class="hl-number">9</span>, <span class="hl-number">6</span>)&gt;,
         &lt;AIC_PINMUX(<span class="hl-string">'E'</span>, <span class="hl-number">10</span>, <span class="hl-number">6</span>)&gt;,
         &lt;AIC_PINMUX(<span class="hl-string">'E'</span>, <span class="hl-number">11</span>, <span class="hl-number">6</span>)&gt;,
         &lt;AIC_PINMUX(<span class="hl-string">'E'</span>, <span class="hl-number">12</span>, <span class="hl-number">6</span>)&gt;,
         &lt;AIC_PINMUX(<span class="hl-string">'E'</span>, <span class="hl-number">13</span>, <span class="hl-number">6</span>)&gt;,
         &lt;AIC_PINMUX(<span class="hl-string">'E'</span>, <span class="hl-number">14</span>, <span class="hl-number">6</span>)&gt;,
         &lt;AIC_PINMUX(<span class="hl-string">'E'</span>, <span class="hl-number">15</span>, <span class="hl-number">6</span>)&gt;;
         bias-disable;
         drive-strength = &lt;<span class="hl-number">3</span>&gt;;
     };
 };</pre></li><li class="- topic/li li" data-ofbid="d46685e106__20250121171517"><strong class="+ topic/ph hi-d/b ph b">MDIO 参数</strong><div class="- topic/p p" data-ofbid="d46685e109__20250121171517">MDIO 参数用于配置 MII
                            BUS：<pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="mac_configuration__codeblock_g21_wws_4dc" data-ofbid="mac_configuration__codeblock_g21_wws_4dc">gmac0_mdio: mdio {
            compatible = <span class="hl-string">"aicmac-mdio"</span>;
            gmac0_phy: ethernet-phy@<span class="hl-number">1</span> {
                    reg = &lt;<span class="hl-number">1</span>&gt;;
            };
    };
};</pre></div><p class="- topic/p p" data-ofbid="d46685e113__20250121171517">MII BUS 用于连接 MAC 和 PHY。</p></li><li class="- topic/li li" data-ofbid="d46685e115__20250121171517">
                        <p class="- topic/p p" data-ofbid="d46685e117__20250121171517">配置 PHY 模块的工作模式，目前 MAC 仅支持 Reduced 接口：</p>
                        <ul class="- topic/ul ul" id="mac_configuration__ul_mp3_cyr_21c" data-ofbid="mac_configuration__ul_mp3_cyr_21c"><li class="- topic/li li" data-ofbid="d46685e121__20250121171517">
                                <p class="- topic/p p" data-ofbid="d46685e123__20250121171517">RMII： 百兆模式</p>
                            </li><li class="- topic/li li" data-ofbid="d46685e126__20250121171517">
                                <p class="- topic/p p" data-ofbid="d46685e128__20250121171517">RGMII：千兆模式</p>
                            </li></ul>
                        <p class="- topic/p p" data-ofbid="d46685e132__20250121171517">如 SoC 中自带了 MAC 模块，则 MAC 在和 PHY 配合工作前，需要匹配好二者的工作模式。</p>
                    </li><li class="- topic/li li" data-ofbid="d46685e135__20250121171517"><strong class="+ topic/ph hi-d/b ph b">百兆功能参数配置</strong><div class="- topic/p p" data-ofbid="d46685e138__20250121171517">参考方案为 <span class="+ topic/ph sw-d/filepath ph filepath">per2-spinand</span>，MAC
                            工作在百兆模式下：<pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="mac_configuration__codeblock_hjg_pyr_21c" data-ofbid="mac_configuration__codeblock_hjg_pyr_21c">&amp;gmac0 {
    pinctrl-names = <span class="hl-string">"default"</span>;
    pinctrl-<span class="hl-number">0</span> = &lt;&amp;gmac0_pins&gt;;
    phy-handle = &lt;&amp;gmac0_phy&gt;;
    phy-reset-gpios = &lt;&amp;gpio_a <span class="hl-number">2</span> GPIO_ACTIVE_HIGH&gt;;
    phy-addr = &lt;<span class="hl-number">1</span>&gt;;
    phy-mode = <span class="hl-string">"rmii"</span>;
    max-speed = &lt;<span class="hl-number">100</span>&gt;;
    aic,use_extclk;

    status = <span class="hl-string">"okay"</span>;

    gmac0_mdio: mdio {
            compatible = <span class="hl-string">"aicmac-mdio"</span>;
            gmac0_phy: ethernet-phy@<span class="hl-number">1</span> {
                    reg = &lt;<span class="hl-number">1</span>&gt;;
            };
    };
};</pre></div></li><li class="- topic/li li" data-ofbid="d46685e145__20250121171517"><strong class="+ topic/ph hi-d/b ph b">千兆功能参数配置</strong><div class="- topic/p p" data-ofbid="d46685e148__20250121171517">参考方案为 <span class="+ topic/ph sw-d/filepath ph filepath">per1</span>，MAC
                            工作在千兆模式下：<pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="mac_configuration__codeblock_pq4_pyr_21c" data-ofbid="mac_configuration__codeblock_pq4_pyr_21c">&amp;gmac0 {
    pinctrl-names = <span class="hl-string">"default"</span>;
    pinctrl-<span class="hl-number">0</span> = &lt;&amp;gmac0_<span class="hl-number">1000</span>m_pins&gt;, &lt;&amp;clk_out2_pins_b&gt;;
    phy-handle = &lt;&amp;gmac0_phy&gt;;
    phy-reset-gpios = &lt;&amp;gpio_f <span class="hl-number">10</span> GPIO_ACTIVE_HIGH&gt;;
    phy-addr = &lt;<span class="hl-number">1</span>&gt;;
    phy-mode = <span class="hl-string">"rgmii"</span>;
    max-speed = &lt;<span class="hl-number">1000</span>&gt;;
    aic,tx-delay = &lt;<span class="hl-number">0xc</span>&gt;;
    aic,rx-delay = &lt;<span class="hl-number">0xc</span>&gt;;

    status = <span class="hl-string">"okay"</span>;

    gmac0_mdio: mdio {
            compatible = <span class="hl-string">"aicmac-mdio"</span>;
            gmac0_phy: ethernet-phy@<span class="hl-number">1</span> {
                    reg = &lt;<span class="hl-number">1</span>&gt;;
            };
    };
};</pre></div></li></ul></div>
        </section><section class="- topic/section section" id="mac_configuration__section_zym_1xs_4dc" data-ofbid="mac_configuration__section_zym_1xs_4dc"><h2 class="- topic/title title sectiontitle">时钟配置</h2>
            
            <div class="- topic/p p" data-ofbid="d46685e161__20250121171517">MAC 和 PHY 的协同工作时，涉及以下时钟配置：<ul class="- topic/ul ul" id="mac_configuration__ul_fhd_syr_21c" data-ofbid="mac_configuration__ul_fhd_syr_21c"><li class="- topic/li li" data-ofbid="d46685e164__20250121171517">MAC 工作时钟<ol class="- topic/ol ol" id="mac_configuration__ol_hn4_5yr_21c" data-ofbid="mac_configuration__ol_hn4_5yr_21c"><li class="- topic/li li" data-ofbid="d46685e167__20250121171517">配置代码<div class="- topic/p p" data-ofbid="d46685e169__20250121171517">MAC 的内部工作时钟通过 PLL_INT1 分频获得，为 50M，
                                    工作时钟不会因为方案的不同而不同，为一固定值。<pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="mac_configuration__codeblock_z3q_tyr_21c" data-ofbid="mac_configuration__codeblock_z3q_tyr_21c">plat-&gt;aicmac_clk = devm_clk_get(&amp;pdev-&gt;dev, AICMAC_RESOURCE_NAME);
clk_set_rate(plat-&gt;aicmac_clk, CSR_F_<span class="hl-number">50</span>M);
clk_prepare_enable(plat-&gt;aicmac_clk);</pre></div></li><li class="- topic/li li" data-ofbid="d46685e173__20250121171517">寄存器查验<pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="mac_configuration__codeblock_ggx_vyr_21c" data-ofbid="mac_configuration__codeblock_ggx_vyr_21c">reg-dump -a <span class="hl-number">0x18020440</span> -c <span class="hl-number">4</span>
<span class="hl-number">0x18020440</span>: <span class="hl-number">00003117</span> <span class="hl-number">00003117</span> <span class="hl-number">00000000</span> <span class="hl-number">00000000</span></pre></li></ol></li><li class="- topic/li li" data-ofbid="d46685e177__20250121171517">PHY 工作时钟<p class="- topic/p p" data-ofbid="d46685e179__20250121171517">PHY 的工作时钟一般为 25M， 通常外挂一个晶振提供时钟给 PHY 模组。D211 对外提供几组时钟，也可以使用该时钟供给
                            PHY 模块工作。</p><div class="- topic/p p" data-ofbid="d46685e181__20250121171517">在 CMU 中使能 PHY 工作时钟 <span class="+ topic/keyword pr-d/parmname keyword parmname">clk-out</span>，且在 MAC
                            中配置
                            IO：<pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="mac_configuration__codeblock_ek2_bzr_21c" data-ofbid="mac_configuration__codeblock_ek2_bzr_21c">&amp;cmu {
    clk-out0 = &lt;<span class="hl-number">25000000</span>&gt;;
    clk-out1 = &lt;<span class="hl-number">25000000</span>&gt;;
    clk-out2 = &lt;<span class="hl-number">25000000</span>&gt;;
    clk-out3 = &lt;<span class="hl-number">25000000</span>&gt;;
    <em class="hl-comment">// clk-out0-enable;</em>
    <em class="hl-comment">// clk-out1-enable;</em>
    <em class="hl-comment">/* Enable clock out2 */</em>
    clk-out2-enable;
    <em class="hl-comment">// clk-out3-enable;</em>
};</pre><pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="mac_configuration__codeblock_b5f_mbr_sdc" data-ofbid="mac_configuration__codeblock_b5f_mbr_sdc">&amp;gmac0 {
    pinctrl-names = <span class="hl-string">"default"</span>;
    pinctrl-<span class="hl-number">0</span> = &lt;&amp;gmac0_<span class="hl-number">1000</span>m_pins&gt;, &lt;&amp;clk_out2_pins_b&gt;;
}</pre></div></li><li class="- topic/li li" data-ofbid="d46685e190__20250121171517">MDC 时钟<div class="- topic/p p" data-ofbid="d46685e192__20250121171517">
                            <ol class="- topic/ol ol" id="mac_configuration__ol_wpq_yyr_21c" data-ofbid="mac_configuration__ol_wpq_yyr_21c"><li class="- topic/li li" data-ofbid="d46685e195__20250121171517">配置代码<pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="mac_configuration__codeblock_olh_xyr_21c" data-ofbid="mac_configuration__codeblock_olh_xyr_21c"><span class="hl-directive">define</span> AICMAC_CSR_DEFAULT      AICMAC_CSR_<span class="hl-number">150</span>_<span class="hl-number">250</span>M
value |= (priv-&gt;plat-&gt;clk_csr &lt;&lt; mdio_data-&gt;mii_reg.clk_csr_shift) &amp;
        mdio_data-&gt;mii_reg.clk_csr_mask;</pre></li><li class="- topic/li li" data-ofbid="d46685e199__20250121171517">寄存器查验<pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="mac_configuration__codeblock_plh_xyr_21c" data-ofbid="mac_configuration__codeblock_plh_xyr_21c">BIT(<span class="hl-number">2</span>,<span class="hl-number">5</span>) 为 <span class="hl-number">0100</span>，<span class="hl-number">150</span>-<span class="hl-number">250</span>MHz

reg-dump -a <span class="hl-number">0x10280090</span> -c <span class="hl-number">4</span>
<span class="hl-number">0x10280090</span>: <span class="hl-number">00000</span>a90 <span class="hl-number">00000000</span> <span class="hl-number">00000000</span> <span class="hl-number">00000000</span></pre></li></ol>
                        </div></li><li class="- topic/li li" data-ofbid="d46685e204__20250121171517">MDATA 时钟<div class="- topic/p p" data-ofbid="d46685e206__20250121171517">MDATA 时钟 (TXC) 为 MAC 和 PHY 进行数据传输的时钟：<ul class="- topic/ul ul" id="mac_configuration__ul_sxj_ryr_21c" data-ofbid="mac_configuration__ul_sxj_ryr_21c"><li class="- topic/li li" data-ofbid="d46685e209__20250121171517">
                                    <p class="- topic/p p" data-ofbid="d46685e211__20250121171517">百兆网络：可以是 MAC 供给 PHY， 也可以是 PHY 供给 MAC</p>
                                </li><li class="- topic/li li" data-ofbid="d46685e214__20250121171517">
                                    <p class="- topic/p p" data-ofbid="d46685e216__20250121171517">千兆网络：只能是 MAC 供给 PHY，RGMII0-TXCK 端口</p>
                                </li></ul><ul class="- topic/ul ul" id="mac_configuration__ul_vvt_qbr_sdc" data-ofbid="mac_configuration__ul_vvt_qbr_sdc"><li class="- topic/li li" data-ofbid="d46685e220__20250121171517">如果 PHY 提供给 MAC：<ul class="- topic/ul ul" id="mac_configuration__ul_txj_ryr_21c" data-ofbid="mac_configuration__ul_txj_ryr_21c"><li class="- topic/li li" data-ofbid="d46685e223__20250121171517">
                                            <p class="- topic/p p" data-ofbid="d46685e225__20250121171517">在 DTS 中设置 <span class="+ topic/keyword pr-d/parmname keyword parmname">aic,use_extclk</span></p>
                                        </li><li class="- topic/li li" data-ofbid="d46685e230__20250121171517">
                                            <p class="- topic/p p" data-ofbid="d46685e232__20250121171517">寄存器：0x18000410 值为 00000002</p>
                                        </li></ul></li><li class="- topic/li li" data-ofbid="d46685e235__20250121171517">如果 MAC 提供给 PHY：<ul class="- topic/ul ul" id="mac_configuration__ul_uxj_ryr_21c" data-ofbid="mac_configuration__ul_uxj_ryr_21c"><li class="- topic/li li" data-ofbid="d46685e238__20250121171517">
                                            <p class="- topic/p p" data-ofbid="d46685e240__20250121171517">在 DTS 中不设置 <span class="+ topic/ph sw-d/filepath ph filepath">aic,use_extclk</span></p>
                                        </li><li class="- topic/li li" data-ofbid="d46685e245__20250121171517">
                                            <p class="- topic/p p" data-ofbid="d46685e247__20250121171517">寄存器：0x18000410 值为 00000000</p>
                                        </li></ul></li></ul></div></li></ul></div>
        </section><section class="- topic/section section" id="mac_configuration__section_nvn_cxs_4dc" data-ofbid="mac_configuration__section_nvn_cxs_4dc"><h2 class="- topic/title title sectiontitle">MAC 地址配置</h2>
            
            <p class="- topic/p p" data-ofbid="d46685e256__20250121171517">MAC 地址的使用优先级如下所示：</p>
            <ol class="- topic/ol ol" id="mac_configuration__ul_ehj_3zr_21c" data-ofbid="mac_configuration__ul_ehj_3zr_21c"><li class="- topic/li li" data-ofbid="d46685e260__20250121171517">调试配置<div class="- topic/p p" data-ofbid="d46685e262__20250121171517">在 <span class="+ topic/ph sw-d/filepath ph filepath">board.dts</span> 的 <code class="+ topic/ph pr-d/codeph ph codeph">gmac</code>
                        配置域中添加下列信息：<pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="mac_configuration__codeblock_vtt_vbr_sdc" data-ofbid="mac_configuration__codeblock_vtt_vbr_sdc"> local-mac-address = [<span class="hl-number">2e</span> f6 <span class="hl-number">01</span> e3 <span class="hl-number">76</span> b6]</pre></div></li><li class="- topic/li li" data-ofbid="d46685e272__20250121171517">用户配置<p class="- topic/p p" data-ofbid="d46685e274__20250121171517">用户生产时配置在特殊数据分区中的 MAC 地址。</p></li><li class="- topic/li li" data-ofbid="d46685e276__20250121171517">加密 CHIPID<p class="- topic/p p" data-ofbid="d46685e278__20250121171517">uboot 中获取 chipID，加密成 mac 地址，并通过 dts 的 local-mac-address 配置给 kernel
                        使用</p></li><li class="- topic/li li" data-ofbid="d46685e280__20250121171517">Random<p class="- topic/p p" data-ofbid="d46685e282__20250121171517">kernel 驱动中在无法从以上获得 mac 地址的时候，会 random 一个值作为 mac 地址使用</p></li></ol>
        </section></div></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">在本页上</div><ul><li class="section-item"><div class="section-title"><a href="#mac_configuration__section_j4p_jts_4dc" data-tocid="mac_configuration__section_j4p_jts_4dc">内核配置</a></div></li><li class="section-item"><div class="section-title"><a href="#mac_configuration__section_nz5_nts_4dc" data-tocid="mac_configuration__section_nz5_nts_4dc">系统参数配置</a></div></li><li class="section-item"><div class="section-title"><a href="#mac_configuration__section_yz1_sts_4dc" data-tocid="mac_configuration__section_yz1_sts_4dc">功能参数配置</a></div></li><li class="section-item"><div class="section-title"><a href="#mac_configuration__section_zym_1xs_4dc" data-tocid="mac_configuration__section_zym_1xs_4dc">时钟配置</a></div></li><li class="section-item"><div class="section-title"><a href="#mac_configuration__section_nvn_cxs_4dc" data-tocid="mac_configuration__section_nvn_cxs_4dc">MAC 地址配置</a></div></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
    <title>footer def</title>
    <style><!--

.p1 {
  font-family: FangZhengShuSong, Times, serif;
}
.p2 {
  font-family: Arial, Helvetica, sans-serif;
}
.p3 {
  font-family: "Lucida Console", "Courier New", monospace;
}
    
--></style>
  

  
    
  
  
    
            
   
  

  <div class="webhelp.fragment.footer">
    <p class="p1">Copyright © 2019-2024 广东匠芯创科技有限公司. All rights reserved.</p>
  </div><div>
    <div class="generation_time">
      Update Time: 2025-01-21
    </div>        
  </div>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
    <script src="${pd}/publishing/publishing-styles-AIC-template/js/custom.js" defer="defer"></script>

        
    </body>
</html>